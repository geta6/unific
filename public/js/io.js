!function(){$(function(){var e,t,n,i,o,d;return $(".alert").hide(),$("button.close").click(function(e){return e.currentTarget.parentElement.style.display="none"}),d=io.connect(),o=window.location.pathname.substr(1),e=[],d.on("connect",function(){return i()?(d.emit("connect stream",o),d.emit("sync stream",o),0===e.length&&$("#NoFeedIsAdded").show(),setInterval(function(){return console.log("sync"),d.emit("sync stream",o)},3e4),$("#FindFeedButton").click(function(){var e;return $("#NoFeedIsFound").hide(),e=$("#FindFeedInput").val(),d.emit("find feed",e)}),d.on("found feed",function(e,t){var n,i,o,d,a;if(null!=e&&$("#NoFeedIsFound").show(),null!=t.candidates){for($("#CandidatesModalWindow").find("#CandidatesList").html(""),a=t.candidates,o=0,d=a.length;d>o;o++)i=a[o],i.sitetitle=""+i.sitename+" - "+(i.title||"feed"),n="<li><input type='checkbox' siteurl="+t.url+" title= '"+i.sitetitle+"' value='"+i.url+"'>  "+i.sitetitle+"</li>",$("#CandidatesList").append(n);return $("#CandidatesModalWindow").modal()}}),d.on("sync completed",function(i){return n(e,i,function(n){var i,o,d;for(n.length>0?console.log("new article added"):console.log("no article added"),e=e.concat(n),e=_.uniq(e,function(e){return e.page._id}),0!==e.length&&$("#NoFeedIsAdded").hide(),o=0,d=n.length;d>o;o++)i=n[o],t(i);return n.length>0?$("#NewArticleIsAdded").show().fadeIn(500):void 0})}),$("#AddFeedButton").click(function(){var e;return e=[],$("#CandidatesList").find(":checkbox:checked").each(function(){return e.push({url:$(this).val(),title:$(this).attr("title"),siteurl:$(this).attr("siteurl")})}),0!==e.length?d.emit("add feed",{urls:e,stream:o}):void 0}),d.on("add-feed succeed",function(){return $("#NewFeedIsAdded").show(),console.log("sync"),d.emit("sync stream",o)}),d.on("error",function(){return $("#SomethingWrong").show()})):$("#GoButton").click(function(){return window.location.href=$("#GoInput").val()})}),i=function(){return""===o?!1:!0},n=function(e,t,n){var i,o;return o=_.map(e,function(e){return e.page._id}),i=_.filter(t,function(e){return _.contains(o,e.page._id)?!1:!0}),n(i)},t=function(e){var t,n,i,o,d,a,r;return a=e.page.title,t=e.page.comments,n=e.page.description,i=moment(e.page.pubDate).fromNow(),r=e.page.url,o=e.feed.title,d=e.feed.site,$("#Articles").prepend("<li class='media well'><div class='media-body'><a href="+r+"><h4 class='media-heading'>"+a+"         <a href='"+d+"''>   <small>"+o+"</small></a></h4><i class='icon-pencil'> "+i+"</i>  <i class='icon-comments-alt'>  Comments("+t.length+") </i><i class='icon-star-empty'> starred</i></a><p>"+n+"</p><button class='btn'>Read More</button>   <button class='btn btn-info'><i class='icon-star'></i>  Star</button></div></li>").hide().fadeIn(300)}})}.call(this);