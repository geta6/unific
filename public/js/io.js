!function(){$(function(){var e,n,t,i,o,a;return $(".alert").hide(),$("button.close").click(function(e){return e.currentTarget.parentElement.style.display="none"}),a=io.connect(),o=window.location.pathname.substr(1),e=[],a.on("connect",function(){return i()?(a.emit("connect stream",o),a.emit("sync stream",o),0===e.length&&$("#NoFeedIsAdded").show(),setInterval(function(){return console.log("sync"),a.emit("sync stream",o)},3e5),$("#FindFeedButton").click(function(){var e;return $("#NoFeedIsFound").hide(),e=$("#FindFeedInput").val(),a.emit("find feed",e)}),a.on("found feed",function(e,n){var t,i,o,a,d;if(null!=e&&$("#NoFeedIsFound").show(),null!=n.candidates){for($("#CandidatesModalWindow").find("#CandidatesList").html(""),d=n.candidates,o=0,a=d.length;a>o;o++)i=d[o],i.sitetitle=""+i.sitename+" - "+(i.title||"feed"),t="<li><input type='checkbox' siteurl="+n.url+" title= '"+i.sitetitle+"' value='"+i.url+"'>  "+i.sitetitle+"</li>",$("#CandidatesList").append(t);return $("#CandidatesModalWindow").modal()}}),a.on("sync completed",function(i){return t(e,i,function(t){var i,o,a;for(t.length>0?console.log("new article added"):console.log("no article added"),e=e.concat(t),e=_.uniq(e,function(e){return e.page._id}),0!==e.length&&$("#NoFeedIsAdded").hide(),o=0,a=t.length;a>o;o++)i=t[o],n(i);return t.length>0?$("#NewArticleIsAdded").show().fadeIn(500):void 0})}),$("#AddFeedButton").click(function(){var e;return e=[],$("#CandidatesList").find(":checkbox:checked").each(function(){return e.push({url:$(this).val(),title:$(this).attr("title"),siteurl:$(this).attr("siteurl")})}),0!==e.length?a.emit("add feed",{urls:e,stream:o}):void 0}),a.on("add-feed succeed",function(){return $("#NewFeedIsAdded").show(),console.log("sync"),a.emit("sync stream",o)}),a.on("error",function(){return $("#SomethingWrong").show()})):$("#GoButton").click(function(){return window.location.href=$("#GoInput").val()})}),i=function(){return""===o?!1:!0},t=function(e,n,t){var i,o;return o=_.map(e,function(e){return e.page._id}),i=_.filter(n,function(e){return _.contains(o,e.page._id)?!1:!0}),t(i)},n=function(e){var n,t,i,o,a,d,l;return d=e.page.title,n=e.page.comments,t=e.page.description,i=moment(e.page.pubDate).fromNow(),l=e.page.url,o=e.feed.title,a=e.feed.site,$("#Articles").prepend("<li class='media well'><div class='media-body'><a href="+l+"><h4 class='media-heading'>"+d+"   <a href='"+a+"''>   <small>"+o+"</small></a></h4><i class='icon-pencil'> "+i+"</i>  <i class='icon-comments-alt'>  Comments("+n.length+") </i><i class='icon-star-empty'> starred</i></a><p>"+t+"</p><button class='btn'>Read More</button>   <button class='btn btn-info'><i class='icon-star'></i>  Star</button></div></li>").hide().fadeIn(300)}})}.call(this);